<!-- vim: set tabstop=2 softtabstop=2 shiftwidth=2 noexpandtab textwidth=80 : -->
<!-- ============================================================
FRAGMENTO: SIDEBAR (MENÚ LATERAL DE NAVEGACIÓN)
============================================================ -->
<!--
Este fragmento define el menú lateral izquierdo de la aplicación,
visible solo cuando el usuario está logado.
-->
<aside th:fragment="sidebar" class="sidebar" th:if="${session.user != null}">
	<nav>
		<ul>
			<!-- Opciones generales -->
			<li><a th:href="@{/main}">Inicio</a></li>
			<li><a th:href="@{/user/details/{id}(id=${session.user.id})}">Mi perfil</a></li>
			<li><a th:href="@{/user/change-password/{id}(id=${session.user.id})}">Cambiar contraseña</a></li>

			<!-- Opciones solo visibles para administradores -->
			<li th:if="${session.user.admin}">
				<a th:href="@{/userlist/list}">Administrar usuarios</a>
			</li>
			<li th:if="${session.user.admin}">
				<a th:href="@{/register}">Dar de alta usuario</a>
			</li>
			<li th:if="${session.user.admin}">
				<a th:href="@{/downloads/users.sql}" download>Descargar usuarios (SQL)</a>
			</li>

			<!-- Opción común -->
			<li><a th:href="@{/logout}">Cerrar sesión</a></li>
		</ul>
	</nav>
</aside>

<!-- ============================================================
NOTAS DE DISEÑO Y FUNCIONAMIENTO
============================================================ -->
<!--
1. VISIBILIDAD DEL MENÚ
-------------------------
El menú lateral solo se renderiza si existe un objeto `session.user`
en la sesión activa, lo que indica que hay un usuario autenticado.

2. OPCIONES EXCLUSIVAS DE ADMINISTRADOR
----------------------------------------
Las opciones de administración se muestran únicamente cuando
`${session.user.admin}` es true, es decir, cuando el usuario tiene
privilegios de administrador.

Actualmente incluyen:
 - "Administrar usuarios"
 - "Dar de alta usuario"
 - "Descargar usuarios (SQL)"

3. DESCARGA DIRECTA DEL ARCHIVO SQL
-----------------------------------
El enlace:
    <a th:href="@{/downloads/users.sql}" download>
permite descargar directamente el archivo `users.sql` ubicado en
`src/main/resources/static/downloads/users.sql`.

Spring Boot sirve automáticamente los recursos estáticos ubicados en:
 - `/static`
 - `/public`
 - `/resources`

Por tanto, no se requiere controlador específico para la descarga.

4. OBJETIVO PEDAGÓGICO
------------------------
Demuestra cómo controlar la visibilidad del contenido en función del
rol del usuario (usando `th:if`) y cómo vincular enlaces a recursos
estáticos servidos desde `/static`.
-->