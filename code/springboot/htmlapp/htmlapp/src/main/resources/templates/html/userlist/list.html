<!-- vim: set tabstop=2 softtabstop=2 shiftwidth=2 noexpandtab textwidth=80 : -->
<!-- ============================================================
LISTADO DE USUARIOS (ADMIN)
============================================================ -->
<html th:replace="~{fragments/layout :: layout(
	title='Listado de usuarios',
	content=~{::main},
	scripts=~{}
)}">

<main class="content-area">
	<!-- ============================================================
	CABECERA DESCRIPTIVA
	============================================================ -->
	<section class="info-box">
		<h1>GestiÃ³n de usuarios</h1>
		<p>
			Desde aquÃ­ puedes ver, editar o eliminar usuarios,
			asÃ­ como gestionar privilegios de administrador.
		</p>
	</section>

	<!-- ============================================================
	SECCIÃ“N PRINCIPAL DEL LISTADO
	============================================================ -->
	<section class="info-box table-wide">
		<!-- Solo visible para administradores -->
		<div th:if="${session.user.admin}">
			<form th:action="@{/userlist/bulk-confirm}" method="post">

				<!-- Contenedor con scroll horizontal -->
				<div class="table-container">
					<table class="table">
						<thead>
							<tr>
								<th><input type="checkbox" id="select-all" /></th>
								<th>Email</th>
								<th>Nombre completo</th>
								<th>Administrador</th>
								<th>Fecha de creaciÃ³n</th>
								<th style="text-align: right;">Acciones</th>
							</tr>
						</thead>

						<tbody>
							<tr th:each="user : ${users}">
								<td>
									<input type="checkbox" name="ids"
									       th:value="${user.id}"
									       th:disabled="${session.user.id == user.id}" />
								</td>

								<td th:text="${user.email}">correo@ejemplo.com</td>
								<td th:text="${user.fullName}">Nombre Apellido</td>
								<td th:text="${user.admin ? 'SÃ­' : 'No'}">No</td>
								<td th:text="${#temporals.format(user.creationTimestamp, 'yyyy-MM-dd HH:mm')}">
									2025-11-03 14:00
								</td>

								<!-- Columna de acciones -->
								<td class="table-actions">
									<a th:href="@{'/user/details/' + ${user.id}}"
									   class="icon-btn" title="Ver detalles">ğŸ”</a>
									<a th:href="@{'/user/edit/' + ${user.id}}"
									   class="icon-btn" title="Editar usuario">âœï¸</a>
									<a th:href="@{'/user/delete/' + ${user.id}}"
									   class="icon-btn"
									   th:if="${session.user.id != user.id}"
									   title="Eliminar usuario">ğŸ—‘ï¸</a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- Acciones masivas -->
				<div class="bulk-actions">
					<select name="action" required>
						<option value="">-- Seleccionar acciÃ³n --</option>
						<option value="GRANT">Hacer administradores</option>
						<option value="REVOKE">Quitar privilegios</option>
						<option value="DELETE">Eliminar usuarios</option>
					</select>
					<button type="submit" class="btn btn-success">Aplicar</button>
				</div>
			</form>
		</div>

		<!-- Si el usuario no es administrador -->
		<div th:unless="${session.user.admin}">
			<p>No tiene permisos para ver esta pÃ¡gina.</p>
		</div>
	</section>
</main>
</html>

<!-- ============================================================
NOTAS DE DISEÃ‘O Y FUNCIONAMIENTO
============================================================ -->
<!--
1. La clase `.content-area` garantiza que el contenido principal
   no se solape con el sidebar y mantenga un ancho fluido.

2. `.info-box` â†’ usada para bloques descriptivos o introductorios.
   `.info-box.table-wide` â†’ para secciones con tablas amplias.

3. `.table-container` aplica scroll horizontal si la tabla
   supera el ancho disponible en pantallas pequeÃ±as.

4. Compatible con `layout.html`, `tables.css` y `layout.css`
   con el nuevo sistema modular de estilos.
-->